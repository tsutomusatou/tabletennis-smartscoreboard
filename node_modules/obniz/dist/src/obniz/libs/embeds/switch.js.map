{"version":3,"sources":["../src/obniz/libs/embeds/switch.ts"],"names":[],"mappings":";AAAA;;;GAGG;;AAEH,0DAAwD;AAQxD;;;GAGG;AACH,MAAqB,WAAY,SAAQ,oCAAiB;IAwBxD,YAAY,KAAU,EAAE,IAAS;QAC/B,KAAK,CAAC,KAAK,CAAC,CAAC;QACb,IAAI,CAAC,EAAE,CAAC,yBAAyB,EAAE,CAAC,GAAG,EAAE,EAAE;YACzC,IAAI,CAAC,KAAK,GAAG,GAAG,CAAC,KAAK,CAAC;YACvB,IAAI,CAAC,KAAK,CAAC,uBAAuB,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;QAChE,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,MAAM,EAAE,CAAC;IAChB,CAAC;IAED;;;;;;;;;;;;OAYG;IACI,KAAK,CAAC,OAAO;QAClB,MAAM,GAAG,GAAQ,EAAE,CAAC;QACpB,GAAG,CAAC,MAAM,GAAG,KAAK,CAAC;QACnB,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,sBAAsB,CAAC,GAAG,EAAE,yBAAyB,CAAC,CAAC;QAC/E,OAAO,IAAI,CAAC,KAAK,CAAC;IACpB,CAAC;IAED;;;;;;;;;;;;;;;;;;;OAmBG;IACI,KAAK,CAAC,SAAS,CAAC,KAAuB;QAC5C,OAAO,CAAC,EAAE;YACR,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,yBAAyB,CAAC,CAAC;YACnE,IAAI,KAAK,KAAK,IAAI,CAAC,KAAK,EAAE;gBACxB,OAAO;aACR;SACF;IACH,CAAC;IAEM,cAAc;QACnB,OAAO,QAAQ,CAAC;IAClB,CAAC;IAES,MAAM;QACd,IAAI,CAAC,KAAK,GAAG,MAAM,CAAC;IACtB,CAAC;CACF;AA1FD,8BA0FC","file":"switch.js","sourcesContent":["/**\n * @packageDocumentation\n * @module ObnizCore.Components\n */\n\nimport { ComponentAbstract } from \"../ComponentAbstact\";\n\n/**\n * switch state\n */\ntype ObnizSwitchState = \"none\" | \"push\" | \"left\" | \"right\";\ntype ObnizSwitchCallback = (result: ObnizSwitchState) => void;\n\n/**\n * The embedded switch on obniz Board.\n * @category Embeds\n */\nexport default class ObnizSwitch extends ComponentAbstract {\n  /**\n   * current switch state\n   */\n  public state!: ObnizSwitchState;\n\n  /**\n   * When the switch state changes, this callback function will be called.\n   * If you press and release a switch, it callbacks twice (\"push\" and \"none\").\n   *\n   * ```javascript\n   * // Javascript Example\n   * obniz.display.clear();\n   * obniz.switch.onchange = function(state) {\n   *   if (state === \"push\") {\n   *     obniz.display.print(\"Pushing\");\n   *   } else {\n   *     obniz.display.clear();\n   *   }\n   * }\n   * ```\n   */\n  public onchange?: ObnizSwitchCallback;\n\n  constructor(obniz: any, info: any) {\n    super(obniz);\n    this.on(\"/response/switch/change\", (obj) => {\n      this.state = obj.state;\n      this.Obniz._runUserCreatedFunction(this.onchange, this.state);\n    });\n\n    this._reset();\n  }\n\n  /**\n   * This determines the current status of the switch.\n   *\n   * ```javascript\n   * // Javascript Example\n   * obniz.display.clear();\n   * var state = await obniz.switch.getWait();\n   * if (state === \"push\") {\n   *   obniz.display.print(\"Now Pressed\");\n   * }\n   * ```\n   *\n   */\n  public async getWait(): Promise<ObnizSwitchState> {\n    const obj: any = {};\n    obj.switch = \"get\";\n    const data = await this.sendAndReceiveJsonWait(obj, \"/response/switch/change\");\n    return data.state;\n  }\n\n  /**\n   * With this you wait until the switch status changes to state.\n   *\n   * ```javascript\n   * // Javascript Example\n   * await obniz.switch.stateWait(\"push\");\n   * console.log(\"switch pushed\");\n   *\n   * await obniz.switch.stateWait(\"left\");\n   * console.log(\"switch left\");\n   *\n   * await obniz.switch.stateWait(\"right\");\n   * console.log(\"switch right\");\n   *\n   * await obniz.switch.stateWait(\"none\");\n   * console.log(\"switch none\");\n   * ```\n   *\n   * @param state state for wait\n   */\n  public async stateWait(state: ObnizSwitchState): Promise<void> {\n    while (1) {\n      const data = await this.receiveJsonWait(\"/response/switch/change\");\n      if (state === data.state) {\n        return;\n      }\n    }\n  }\n\n  public schemaBasePath(): string {\n    return \"switch\";\n  }\n\n  protected _reset() {\n    this.state = \"none\";\n  }\n}\n"]}