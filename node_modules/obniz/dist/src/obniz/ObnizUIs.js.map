{"version":3,"sources":["../src/obniz/ObnizUIs.ts"],"names":[],"mappings":"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","file":"ObnizUIs.js","sourcesContent":["/**\n * @packageDocumentation\n * @module ObnizCore\n */\n\nimport dialogPolyfill from \"./libs/webpackReplace/dialogPollyfill\";\nimport { ObnizOptions } from \"./ObnizOptions\";\nimport ObnizSystemMethods from \"./ObnizSystemMethods\";\n\nexport default class ObnizUIs extends ObnizSystemMethods {\n  /**\n   * @ignore\n   */\n  public static _promptQueue: any[] = [];\n\n  /**\n   * @ignore\n   */\n  public static _promptWaiting: boolean = false;\n\n  /**\n   * @ignore\n   */\n  public static _promptCount: number = 0;\n\n  constructor(id: string, options?: ObnizOptions) {\n    super(id, options);\n  }\n\n  /**\n   * This closes the current connection.\n   * You need to set auto_connect to false. Otherwise the connection will be recovered.\n   *\n   * ```javascript\n   * var obniz = new Obniz('1234-5678', {\n   *   auto_connect: false,\n   *   reset_obniz_on_ws_disconnection: false\n   * });\n   *\n   * obniz.connect();\n   * obniz.onconnect = async function() {\n   *   obniz.io0.output(true);\n   *   obniz.close();\n   * }\n   * ```\n   */\n  public close() {\n    super.close();\n    this.updateOnlineUI();\n  }\n\n  protected isValidObnizId(str: string) {\n    if (typeof str !== \"string\" || str.length < 8) {\n      return null;\n    }\n    str = str.replace(\"-\", \"\");\n    let id: any = parseInt(str);\n    if (isNaN(id)) {\n      id = null;\n    }\n    return id !== null;\n  }\n\n  protected wsconnect(desired_server: any) {\n    this.showOffLine();\n    if (!this.isValidObnizId(this.id)) {\n      if (this.isNode) {\n        this.error(\"invalid obniz id\");\n      } else {\n        const filled: any = _ReadCookie(\"obniz-last-used\") || \"\";\n        this.prompt(filled, (obnizid: any) => {\n          this.id = obnizid;\n          this.wsconnect(desired_server);\n        });\n      }\n      return;\n    }\n    super.wsconnect(desired_server);\n  }\n\n  protected prompt(filled: string = \"\", callback: any) {\n    ObnizUIs._promptQueue.push({ filled, callback });\n    this._promptNext();\n  }\n\n  protected _promptNext() {\n    if (ObnizUIs._promptWaiting) {\n      return;\n    }\n    const next = ObnizUIs._promptQueue.shift();\n    if (next) {\n      ObnizUIs._promptWaiting = true;\n      if (document.readyState !== \"loading\") {\n        this._promptOne(next.filled, next.callback);\n      } else {\n        document.addEventListener(\"DOMContentLoaded\", () => {\n          this._promptOne(next.filled, next.callback);\n        });\n      }\n    }\n  }\n\n  protected _promptOne(filled: any, callback: any) {\n    ObnizUIs._promptCount++;\n    let result = \"\";\n    new Promise((resolve: any) => {\n      const text = filled;\n      const selectorId = `obniz-id-prompt${ObnizUIs._promptCount}`;\n      let css: string = dialogPolyfill.css;\n      css +=\n        `dialog#${selectorId}::backdrop {\\n` +\n        \"  background: rgba(0, 0, 0, 0.5);\\n\" +\n        \"  animation: modal-open .4s ease;\\n\" +\n        \"}\\n\" +\n        \"\\n\" +\n        `dialog#${selectorId}[open] {\\n` +\n        \"    position: fixed;\\n\" +\n        \"    bottom: auto;\\n\" +\n        \"    top: 10px;\" +\n        \"    animation: modal-slide .5s ease;\\n\" +\n        \"    border: none;\" +\n        \"    padding: 0;\" +\n        \"}\\n\" +\n        `dialog#${selectorId} .contents {\\n` +\n        \"    padding: 1em;\" +\n        \"}\\n\" +\n        `dialog#${selectorId} button {\\n` +\n        \"    background-color: #00a4e3;\\n\" +\n        \"    border-color: #00a4e3;\\n\" +\n        \"    color: white;\\n\" +\n        \"}\" +\n        \"@keyframes modal-open {\\n\" +\n        \"  0% {\\n\" +\n        \"    opacity: 0;\\n\" +\n        \"  }\\n\" +\n        \"  100%{\\n\" +\n        \"    opacity: 1;\\n\" +\n        \"  }\\n\" +\n        \"}\\n\" +\n        \"\\n\" +\n        \"@keyframes modal-slide {\\n\" +\n        \"  0% {\\n\" +\n        \"    transform: translateY(-20px);\\n\" +\n        \"  }\\n\" +\n        \"  100%{\\n\" +\n        \"    transform: translateY(0);\\n\" +\n        \"  }\\n\" +\n        \"}\";\n\n      let html = \"\";\n      html += `<dialog id='${selectorId}'><div class=\"contents\">`;\n      html += `Connect obniz device`;\n      if (ObnizUIs._promptCount > 1) {\n        html += `(${ObnizUIs._promptCount})`;\n      }\n      html += `<br/>`;\n      html += ` <form method=\"dialog\">`;\n      html += ` <input type=\"text\" name=\"obniz-id\" id=\"return_value\" value=\"${text}\" placeholder=\"obniz id\">`;\n      html += '  <button id=\"close\">Connect</button>';\n      html += \"</form>\";\n      html += \"</div></dialog>\";\n      html += \"<style>\";\n      html += css;\n      html += \"</style>\";\n\n      const div = document.createElement(\"div\");\n      div.innerHTML = html;\n      const dialog: HTMLDialogElement = div.querySelector(\"dialog\") as HTMLDialogElement;\n      dialog.addEventListener(\"click\", () => {\n        // cancel\n        (dialog.querySelector(\"#return_value\") as HTMLInputElement).value = \"\";\n        dialog.close();\n        resolve();\n      });\n      (dialog.querySelector(\".contents\") as HTMLElement).addEventListener(\"click\", (event) => {\n        event.stopPropagation();\n      });\n\n      dialog.addEventListener(\"close\", (param) => {\n        const inputValue = (dialog.querySelector(\"#return_value\") as HTMLInputElement).value;\n        div.parentElement!.removeChild(div);\n        result = inputValue;\n        resolve();\n      });\n\n      dialog.addEventListener(\"cancel\", (param) => {\n        // escape key\n        const inputValue = (dialog.querySelector(\"#return_value\") as HTMLInputElement).value;\n        div.parentElement!.removeChild(div);\n        resolve();\n      });\n      document.body.appendChild(div);\n      dialogPolyfill.dialogPolyfill.registerDialog(dialog);\n      dialog.showModal();\n    }).then(() => {\n      ObnizUIs._promptWaiting = false;\n\n      if (result && result.length > 0) {\n        // @ts-ignore\n        callback(result);\n      }\n      this._promptNext();\n    });\n  }\n\n  protected showAlertUI(obj: any) {\n    if (this.isNode || !document.getElementById(this.options.debug_dom_id)) {\n      return;\n    }\n    const dom: any = `\n    <div style=\"background-color:${obj.alert === \"warning\" ? \"#ffee35\" : \"#ff7b34\"}\">${obj.message}</div>`;\n    document.getElementById(this.options.debug_dom_id)!.insertAdjacentHTML(\"beforeend\", dom);\n  }\n\n  protected getDebugDoms() {\n    if (this.isNode) {\n      return;\n    }\n    const loaderDom: any = document.querySelector(\"#loader\");\n    const debugDom: any = document.querySelector(\"#\" + this.options.debug_dom_id);\n    let statusDom: any = document.querySelector(\"#\" + this.options.debug_dom_id + \" #online-status\");\n    if (debugDom && !statusDom) {\n      statusDom = document.createElement(\"div\");\n      statusDom.id = \"online-status\";\n      statusDom.style.color = \"#FFF\";\n      statusDom.style.padding = \"5px\";\n      statusDom.style.textAlign = \"center\";\n      debugDom.insertBefore(statusDom, debugDom.firstChild);\n    }\n    return { loaderDom, debugDom, statusDom };\n  }\n\n  /* online offline */\n\n  protected _callOnConnect() {\n    this.updateOnlineUI();\n    super._callOnConnect();\n  }\n\n  protected _disconnectLocal() {\n    super._disconnectLocal();\n    this.updateOnlineUI();\n  }\n\n  protected updateOnlineUI() {\n    if (this.isNode) {\n      return;\n    }\n\n    const isConnected: any = this.socket && this.socket.readyState === 1;\n    const isConnectedLocally: any = this.socket_local && this.socket_local.readyState === 1;\n    if (isConnected && isConnectedLocally) {\n      this.showOnLine(true);\n    } else if (isConnected) {\n      this.showOnLine(false);\n    } else {\n      this.showOffLine();\n    }\n  }\n\n  protected showOnLine(isConnectedLocally: any) {\n    if (this.isNode) {\n      return;\n    }\n    const doms: any = this.getDebugDoms();\n    if (doms.loaderDom) {\n      doms.loaderDom.style.display = \"none\";\n    }\n    if (doms.statusDom) {\n      doms.statusDom.style.backgroundColor = isConnectedLocally ? \"#0cd362\" : \"#31965d\";\n      doms.statusDom.style.color = \"#FFF\";\n      doms.statusDom.innerHTML =\n        (this.id ? \"online : \" + this.id : \"online\") + (isConnectedLocally ? \" via local_connect\" : \" via internet\");\n    }\n  }\n\n  protected showOffLine() {\n    if (this.isNode) {\n      return;\n    }\n\n    const doms: any = this.getDebugDoms();\n    if (doms.loaderDom) {\n      doms.loaderDom.style.display = \"block\";\n    }\n    if (doms.statusDom) {\n      doms.statusDom.style.backgroundColor = \"#d9534f\";\n      doms.statusDom.style.color = \"#FFF\";\n      doms.statusDom.innerHTML = this.id ? \"offline : \" + this.id : \"offline\";\n    }\n  }\n}\n\n/**\n *\n * @ignore\n */\nfunction _ReadCookie(name: any) {\n  const nameEQ: any = name + \"=\";\n  const ca: any = document.cookie.split(\";\");\n  for (let i = 0; i < ca.length; i++) {\n    let c: any = ca[i];\n    while (c.charAt(0) === \" \") {\n      c = c.substring(1, c.length);\n    }\n    if (c.indexOf(nameEQ) === 0) {\n      return c.substring(nameEQ.length, c.length);\n    }\n  }\n  return null;\n}\n"]}