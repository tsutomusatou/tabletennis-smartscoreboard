{"version":3,"sources":["../src/parts/Keyestudio/Keyestudio_HT16K33/index.ts"],"names":[],"mappings":"AAAA;;;GAGG;AAEH,OAAO,KAAK,MAAM,gBAAgB,CAAC;AACnC,OAAO,EAAE,cAAc,EAAE,MAAM,oCAAoC,CAAC;AACpE,OAAO,iBAAiB,EAAE,EAAE,wBAAwB,EAAE,MAAM,iCAAiC,CAAC;AAE9F,MAAM,WAAW,yBAA0B,SAAQ,wBAAwB;CAAG;AAE9E,MAAM,CAAC,OAAO,OAAO,kBAAmB,SAAQ,iBAAiB;WACjD,IAAI,IAAI,cAAc;IAMpC,OAAO,CAAC,QAAQ,CAAsC;IAE/C,KAAK,CAAC,KAAK,EAAE,KAAK;IAKlB,IAAI,CAAC,GAAG,EAAE,wBAAwB;IAgBlC,IAAI,CAAC,IAAI,EAAE,MAAM,EAAE;CAW3B","file":"index.d.ts","sourcesContent":["/**\n * @packageDocumentation\n * @module Parts.Keyestudio_HT16K33\n */\n\nimport Obniz from \"../../../obniz\";\nimport { ObnizPartsInfo } from \"../../../obniz/ObnizPartsInterface\";\nimport MatrixLED_HT16K33, { MatrixLED_HT16K33Options } from \"../../Display/MatrixLED_HT16K33\";\n\nexport interface Keyestudio_HT16K33Options extends MatrixLED_HT16K33Options {}\n\nexport default class Keyestudio_HT16K33 extends MatrixLED_HT16K33 {\n  public static info(): ObnizPartsInfo {\n    return {\n      name: \"Keyestudio_HT16K33\",\n    };\n  }\n\n  private bitArray: number[] = [7, 0, 1, 2, 3, 4, 5, 6];\n\n  public wired(obniz: Obniz) {\n    super.wired(obniz);\n    super.init(8);\n  }\n\n  public draw(ctx: CanvasRenderingContext2D) {\n    const imageData = ctx.getImageData(0, 0, this.width, this.height);\n    const data = imageData.data;\n    for (let i = 0; i < this.height; i++) {\n      this.vram[i] = 0;\n      for (let j = 0; j < this.width; j++) {\n        const pos = i * this.height * 4 + j * 4;\n        const brightness = 0.34 * data[pos] + 0.5 * data[pos + 1] + 0.16 * data[pos + 2];\n        if (brightness > 0x7f) {\n          this.vram[i] |= 0x1 << this.bitArray[j];\n        }\n      }\n    }\n    super.writeVram();\n  }\n\n  public dots(data: number[]) {\n    for (let i = 0; i < this.height; i++) {\n      this.vram[i] = 0;\n      for (let j: number = 0; j < this.width; j++) {\n        if (data[i] & (1 << j)) {\n          this.vram[i] |= 0x1 << this.bitArray[j];\n        }\n      }\n    }\n    super.writeVram();\n  }\n}\n"]}