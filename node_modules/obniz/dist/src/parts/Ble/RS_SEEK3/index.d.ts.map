{"version":3,"sources":["../src/parts/Ble/RS_SEEK3/index.ts"],"names":[],"mappings":"AAAA;;;GAGG;AAEH,OAAO,KAAK,MAAM,gBAAgB,CAAC;AAEnC,OAAO,mBAAmB,MAAM,uDAAuD,CAAC;AACxF,OAAO,sBAAsB,MAAM,uCAAuC,CAAC;AAC3E,OAA4B,EAAE,cAAc,EAAE,MAAM,oCAAoC,CAAC;AAEzF,MAAM,WAAW,eAAe;CAAG;AAEnC,MAAM,CAAC,OAAO,OAAO,QAAS,YAAW,sBAAsB;WAC/C,IAAI,IAAI,cAAc;WAMtB,QAAQ,CAAC,UAAU,EAAE,mBAAmB;IAO/C,IAAI,EAAE,MAAM,EAAE,CAAM;IACpB,YAAY,EAAE,MAAM,EAAE,CAAM;IAC5B,MAAM,EAAE,GAAG,CAAC;IACZ,SAAS,EAAE,CAAC,MAAM,IAAI,CAAC,GAAG,IAAI,CAAQ;IACtC,WAAW,EAAE,mBAAmB,GAAG,IAAI,CAAQ;IAC/C,YAAY,CAAC,EAAE,CAAC,MAAM,EAAE,GAAG,KAAK,IAAI,CAAC;IAE5C,OAAO,CAAC,MAAM,CAIZ;IACF,OAAO,CAAC,qBAAqB,CAAwC;IACrE,OAAO,CAAC,wBAAwB,CAAwC;gBAE5D,UAAU,EAAE,mBAAmB,GAAG,IAAI;IAQ3C,KAAK,CAAC,KAAK,EAAE,KAAK,GAAG,IAAI;IAEnB,WAAW;IA0BX,cAAc;IAId,gBAAgB,IAAI,OAAO,CAAC;QAAE,WAAW,EAAE,MAAM,CAAC;QAAC,QAAQ,EAAE,MAAM,CAAA;KAAE,CAAC;CAOpF","file":"index.d.ts","sourcesContent":["/**\n * @packageDocumentation\n * @module Parts.RS_Seek3\n */\n\nimport Obniz from \"../../../obniz\";\nimport BleRemoteCharacteristic from \"../../../obniz/libs/embeds/bleHci/bleRemoteCharacteristic\";\nimport BleRemotePeripheral from \"../../../obniz/libs/embeds/bleHci/bleRemotePeripheral\";\nimport ObnizPartsBleInterface from \"../../../obniz/ObnizPartsBleInterface\";\nimport ObnizPartsInterface, { ObnizPartsInfo } from \"../../../obniz/ObnizPartsInterface\";\n\nexport interface RS_Seek3Options {}\n\nexport default class RS_Seek3 implements ObnizPartsBleInterface {\n  public static info(): ObnizPartsInfo {\n    return {\n      name: \"RS_Seek3\",\n    };\n  }\n\n  public static isDevice(peripheral: BleRemotePeripheral) {\n    if (peripheral.localName !== \"Seek3\") {\n      return false;\n    }\n    return true;\n  }\n\n  public keys: string[] = [];\n  public requiredKeys: string[] = [];\n  public params: any;\n  public onpressed: (() => void) | null = null;\n  public _peripheral: BleRemotePeripheral | null = null;\n  public ondisconnect?: (reason: any) => void;\n\n  private _uuids = {\n    service: \"0EE71523-981A-46B8-BA64-019261C88478\",\n    buttonChar: \"0EE71524-981A-46B8-BA64-019261C88478\",\n    tempHumidChar: \"0EE7152C-981A-46B8-BA64-019261C88478\",\n  };\n  private _buttonCharacteristic: BleRemoteCharacteristic | null = null;\n  private _tempHumidCharacteristic: BleRemoteCharacteristic | null = null;\n\n  constructor(peripheral: BleRemotePeripheral | null) {\n    if (peripheral && !RS_Seek3.isDevice(peripheral)) {\n      throw new Error(\"peripheral is not RS_Seek3\");\n    }\n    this._peripheral = peripheral;\n  }\n\n  // @ts-ignore\n  public wired(obniz: Obniz): void {}\n\n  public async connectWait() {\n    if (!this._peripheral) {\n      throw new Error(\"RS_Seek3 is not find.\");\n    }\n    this._peripheral.ondisconnect = (reason: any) => {\n      if (typeof this.ondisconnect === \"function\") {\n        this.ondisconnect(reason);\n      }\n    };\n    await this._peripheral.connectWait();\n    this._buttonCharacteristic = this._peripheral\n      .getService(this._uuids.service)!\n      .getCharacteristic(this._uuids.buttonChar);\n    this._tempHumidCharacteristic = this._peripheral\n      .getService(this._uuids.service)!\n      .getCharacteristic(this._uuids.tempHumidChar);\n\n    if (this._buttonCharacteristic) {\n      this._buttonCharacteristic.registerNotify((data: number[]) => {\n        if (typeof this.onpressed === \"function\") {\n          this.onpressed();\n        }\n      });\n    }\n  }\n\n  public async disconnectWait() {\n    await this._peripheral?.disconnectWait();\n  }\n\n  public async getTempHumidWait(): Promise<{ temperature: number; humidity: number }> {\n    if (!this._tempHumidCharacteristic) {\n      throw new Error(\"device is not connected\");\n    }\n    const data = await this._tempHumidCharacteristic.readWait();\n    return { temperature: data[0], humidity: data[1] };\n  }\n}\n"]}